<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>„Åó„ÇÉ„Åº„ÇìÁéâ„ÅΩ„Çì„ÅΩ„Çì</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            touch-action: manipulation;
            overflow: hidden;
            background: linear-gradient(to bottom, #e0f2fe, #bae6fd);
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', sans-serif;
        }
        .bubble {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.1));
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.5), 0 0 10px rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.4);
            cursor: pointer;
            animation: float-up linear forwards;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            user-select: none;
        }
        @keyframes float-up {
            from { transform: translateY(110vh); }
            to { transform: translateY(-20vh); }
        }
        .pop {
            animation: pop-effect 0.2s ease-out forwards;
        }
        @keyframes pop-effect {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        .score-anim {
            animation: bounce 0.3s ease;
        }
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
    </style>
</head>
<body class="h-screen w-screen m-0 p-0 select-none">

    <!-- Start Screen -->
    <div id="start-screen" class="absolute inset-0 flex flex-col items-center justify-center z-50 bg-white bg-opacity-80 p-6 text-center">
        <h1 class="text-4xl font-bold text-blue-600 mb-8">„Åó„ÇÉ„Åº„ÇìÁéâ„ÅΩ„Çì„ÅΩ„Çì</h1>
        <div class="bg-blue-100 p-6 rounded-3xl shadow-lg mb-8">
            <p class="text-xl text-gray-700 mb-2">„ÅÇ„Åå„Å£„Å¶„Åè„Çã „Åó„ÇÉ„Åº„ÇìÁéâ„Çí</p>
            <p class="text-xl text-gray-700">„Çø„ÉÉ„ÉÅ„Åó„Å¶ „Çè„Å£„Å¶„Åø„Çà„ÅÜÔºÅ</p>
        </div>
        <button id="start-btn" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-6 px-12 rounded-full text-3xl shadow-xl transition-transform active:scale-95">
            „ÅØ„Åò„ÇÅ„Çã
        </button>
    </div>

    <!-- Game UI -->
    <div id="game-ui" class="hidden absolute top-0 left-0 w-full p-4 flex justify-between items-start pointer-events-none z-40">
        <div class="bg-white/70 backdrop-blur-sm rounded-2xl p-3 shadow-md border-2 border-blue-300">
            <p class="text-sm text-blue-600 font-bold">„Å¶„Çì„Åô„ÅÜ</p>
            <p id="score-display" class="text-3xl font-black text-pink-500">0</p>
        </div>
        <div class="bg-white/70 backdrop-blur-sm rounded-2xl p-3 shadow-md border-2 border-blue-300">
            <p class="text-sm text-blue-600 font-bold">„ÅÆ„Åì„Çä„Åò„Åã„Çì</p>
            <p id="timer-display" class="text-3xl font-black text-blue-600">30</p>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="result-screen" class="hidden absolute inset-0 flex flex-col items-center justify-center z-50 bg-white bg-opacity-90 p-6 text-center">
        <h2 class="text-3xl font-bold text-blue-600 mb-4">„Åä„Åó„Åæ„ÅÑÔºÅ</h2>
        <div class="text-6xl font-black text-pink-500 mb-2" id="final-score-display">0</div>
        <p class="text-2xl font-bold text-gray-700 mb-8">„Å¶„Çì „Å®„Çå„Åü„ÇàÔºÅ</p>
        
        <div id="medal-msg" class="text-2xl mb-8 p-4 bg-yellow-100 rounded-2xl border-2 border-yellow-400 text-yellow-700 font-bold">
            „Åô„Åî„ÅÑ„Å≠ÔºÅ
        </div>

        <button id="retry-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-10 rounded-full text-2xl shadow-lg transition-transform active:scale-95">
            „ÇÇ„ÅÜ„ÅÑ„Å£„Åã„ÅÑÔºÅ
        </button>
    </div>

    <!-- Game Container -->
    <div id="game-container" class="relative w-full h-full overflow-hidden"></div>

    <script>
        const gameContainer = document.getElementById('game-container');
        const startScreen = document.getElementById('start-screen');
        const resultScreen = document.getElementById('result-screen');
        const gameUI = document.getElementById('game-ui');
        const scoreDisplay = document.getElementById('score-display');
        const timerDisplay = document.getElementById('timer-display');
        const finalScoreDisplay = document.getElementById('final-score-display');
        const medalMsg = document.getElementById('medal-msg');
        
        const startBtn = document.getElementById('start-btn');
        const retryBtn = document.getElementById('retry-btn');

        let score = 0;
        let timeLeft = 30;
        let gameActive = false;
        let spawnInterval;
        let timerInterval;

        const emojis = ['ü´ß', 'ü´ß', 'ü´ß', '‚ú®', 'üéà', 'üåü'];

        function initGame() {
            score = 0;
            timeLeft = 30;
            scoreDisplay.textContent = score;
            timerDisplay.textContent = timeLeft;
            gameContainer.innerHTML = '';
            
            startScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            gameUI.classList.remove('hidden');
            
            gameActive = true;
            startGameLoop();
        }

        function startGameLoop() {
            // Spawn bubbles
            spawnInterval = setInterval(() => {
                if (gameActive) createBubble();
            }, 600);

            // Timer
            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function createBubble() {
            const bubble = document.createElement('div');
            const size = Math.floor(Math.random() * 40) + 70; // 70-110px
            const xPos = Math.random() * (window.innerWidth - size);
            const duration = Math.random() * 2 + 3; // 3-5 seconds
            const colorIndex = Math.floor(Math.random() * 360);
            
            bubble.className = 'bubble';
            bubble.style.width = `${size}px`;
            bubble.style.height = `${size}px`;
            bubble.style.left = `${xPos}px`;
            bubble.style.animationDuration = `${duration}s`;
            bubble.style.borderColor = `hsla(${colorIndex}, 70%, 70%, 0.6)`;
            
            // Randomly add emojis to some bubbles
            if (Math.random() > 0.7) {
                bubble.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            }

            // Click/Touch event
            const popHandler = (e) => {
                e.preventDefault();
                if (!gameActive) return;
                
                popBubble(bubble);
            };

            bubble.addEventListener('mousedown', popHandler);
            bubble.addEventListener('touchstart', popHandler);

            // Clean up when bubble leaves screen
            bubble.addEventListener('animationend', () => {
                if (bubble.parentNode) {
                    bubble.parentNode.removeChild(bubble);
                }
            });

            gameContainer.appendChild(bubble);
        }

        function popBubble(element) {
            // Visual feedback
            element.classList.add('pop');
            
            // Increment score
            score++;
            scoreDisplay.textContent = score;
            scoreDisplay.parentElement.classList.remove('score-anim');
            void scoreDisplay.parentElement.offsetWidth; // Trigger reflow
            scoreDisplay.parentElement.classList.add('score-anim');

            // Haptic feedback (if available)
            if (window.navigator.vibrate) {
                window.navigator.vibrate(10);
            }

            // Remove from DOM after animation
            setTimeout(() => {
                if (element.parentNode) {
                    element.parentNode.removeChild(element);
                }
            }, 200);
        }

        function endGame() {
            gameActive = false;
            clearInterval(spawnInterval);
            clearInterval(timerInterval);
            
            finalScoreDisplay.textContent = score;
            
            if (score >= 40) {
                medalMsg.textContent = "üèÖ „Å¶„Çì„Åï„ÅÑÔºÅ„Åô„Åî„Åô„Åé„ÇãÔºÅ";
            } else if (score >= 25) {
                medalMsg.textContent = "ü•á „ÉÅ„É£„É≥„Éî„Ç™„É≥ÔºÅ„ÇÑ„Å£„Åü„Å≠ÔºÅ";
            } else if (score >= 10) {
                medalMsg.textContent = "ü•à „Å®„Å£„Å¶„ÇÇ „Åò„Çá„ÅÜ„ÅöÔºÅ";
            } else {
                medalMsg.textContent = "ü•â „Åæ„Åü „Åå„Çì„Å∞„Çç„ÅÜÔºÅ";
            }
            
            gameUI.classList.add('hidden');
            resultScreen.classList.remove('hidden');
        }

        startBtn.onclick = initGame;
        retryBtn.onclick = initGame;

        // Prevent scrolling/zooming for mobile game experience
        document.addEventListener('touchmove', (e) => {
            if (gameActive) e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>